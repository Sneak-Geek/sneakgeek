get:
  get:
    tags:
      - account
    summary: Get user account information
    description: ""
    operationId: getAccount
    parameters:
      - in: header
        name: authorization
        description: JWT for user authorization
        required: true
        type: string
    responses:
      "200":
        description: Get account successfully
        schema:
          type: object
          required:
            - user
          properties:
            user:
              $ref: "../definitions/entities/Account.yaml"
      "400":
        description: Missing access token
      "401":
        description: Invalid access token
      "500":
        description: Internal server error

facebook:
  post:
    tags:
      - account
    summary: Create or log in account using Facebook credential
    description: ""
    operationId: facebookAuth
    parameters:
      - in: header
        name: access_token
        description: User access token for Facebook OAuth
        required: true
        type: string
    responses:
      "200":
        description: Account log in successfully
        schema:
          $ref: "#/definitions/AccountAuthResponse"
      "201":
        description: User profile created successfully (for first time log in only)
        schema:
          $ref: "#/definitions/AccountAuthResponse"
      "401":
        description: Invalid access token
      "500":
        description: Internal server error

email-signup:
  post:
    tags:
      - account
    summary: Create a new account using email
    description: ""
    operationId: emailSignup
    parameters:
      - in: body
        name: body
        description: The email and password used to create account
        required: true
        schema:
          $ref: "#/definitions/EmailAuthRequest"
    responses:
      "201":
        description: Account created successfully
        schema:
          $ref: "#/definitions/AccountAuthResponse"
      "400":
        description: Invalid request
      "500":
        description: Internal server error

email-login:
  post:
    tags:
      - account
    summary: Log in using email and password
    description: ""
    operationId: emailLogin
    parameters:
      - in: body
        name: body
        description: The email and password used to log in
        required: true
        schema:
          $ref: "#/definitions/EmailAuthRequest"
    responses:
      "200":
        description: Account log in successfully
        schema:
          $ref: "#/definitions/AccountAuthResponse"
      "201":
        description: User profile created successfully (for first time log in only)
        schema:
          $ref: "#/definitions/AccountAuthResponse"
      "401":
        description: Invalid email password combination
      "500":
        description: Internal server error

send-confirmation-token:
  post:
    tags:
      - account
    summary: Send confirmation token to specified email address
    description: ""
    operationId: sendConfirmationToken
    parameters:
      - in: body
        name: body
        description: The email address to send confirmation token
        required: true
        schema:
          type: object
          required:
            - email
          properties:
            email:
              type: string
              format: email
    responses:
      "200":
        description: Confirmation token sent
      "400":
        description: Invalid request
      "500":
        description: Internal server error

set-user-password:
  put:
    tags:
      - account
    summary: Set new password for user account
    description: ""
    operationId: setUserPassword
    parameters:
      - in: body
        name: body
        description: ""
        required: true
        schema:
          $ref: "#/definitions/SetPassword"
    responses:
      "200":
        description: Set new password successfully
      "400":
        description: Invalid request
      "401":
        description: Invalid token
      "500":
        description: Internal server error

verify-token:
  post:
    tags:
      - account
    summary: Verify user token for setting up new password
    description: ""
    operationId: verifyToken
    parameters:
      - in: body
        name: body
        description: Email and token for authorization
        required: true
        schema:
          type: object
          required:
            - email
            - token
          properties:
            email:
              type: string
              format: email
            token:
              type: string
    responses:
      "200":
        description: "Token verified"
      "400":
        description: "Invalid request"
      "401":
        description: "Invalid token"
      "500":
        description: "Internal server error"

definitions:
  AccountAuthResponse:
    type: object
    required:
      - user
      - token
    properties:
      user:
        $ref: "../definitions/entities/Account.yaml"
      token:
        $ref: "../definitions/common/JWTToken.yaml"

  EmailAuthRequest:
    type: object
    required:
      - email
      - password
    properties:
      email:
        type: string
        format: email
      password:
        type: string
        example: "abc123"

  SetPassword:
    type: object
    required:
      - email
      - token
      - newPassword
    properties:
      email:
        type: string
        format: email
      token:
        type: string
      newPassword:
        type: string
        example: "abc123"
